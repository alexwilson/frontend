<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.13.6"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:description" content="First, some background: Github Pages is a brilliant way to build static websites quickly and easily. However it is quite
limited as it only…"/><meta data-react-helmet="true" name="twitter:site" content="@alexwilsonv1"/><meta data-react-helmet="true" name="twitter:title" content="Deploying static sites with Github Actions"/><meta data-react-helmet="true" name="twitter:image" content="https://alexwilson.tech/content/717e6a35-1cb5-4a28-9321-592d05ddd9dc/twitter-card.jpg"/><style data-href="/styles.1af39d6047a6fb8c9ec3.css" data-identity="gatsby-global-css">.alex-share ul{display:block;list-style-type:none;margin:0;padding:0}.alex-share ul li{display:inline}.alex-share ul li:not(:last-child){margin-right:.2em}.alex-share ul li img{height:2rem;width:2rem}.alex-header{border-bottom:3px solid #0d0d0d;overflow:hidden;z-index:100}.alex-header--container{margin:0 auto;max-width:1200px;width:90%}.alex-header__nav{display:flex;list-style:none;margin:0;padding:0}@media(max-width:575px){.alex-header__nav--container{padding-bottom:1em;padding-top:1em}.alex-header__nav{background-color:rgba(51,51,51,.7);flex-wrap:wrap;height:100%;justify-items:center;transition:all .2s ease;translate:none}.alex-header__nav[aria-expanded=false]{height:0;overflow:hidden;transform:translateY(-300%);visibility:hidden}}.alex-header__menu-button{background-color:transparent;border:0;cursor:pointer;display:block;height:1.5em;position:relative;width:1.5em}@media(min-width:577px){.alex-header__menu-button{display:none;visibility:hidden}}.alex-header__menu-button>span{background-color:#fff;display:block;height:2px;margin:5px 0;transition:all .2s ease-in;width:1.5em}.alex-header__menu-button[aria-pressed=true]>span:first-child{transform:translateY(7px) rotate(45deg)}.alex-header__menu-button[aria-pressed=true]>span:nth-child(2){opacity:0}.alex-header__menu-button[aria-pressed=true]>span:nth-child(3){transform:translateY(-7px) rotate(-45deg)}.alex-header__nav-item{flex-basis:auto;overflow:hidden;white-space:nowrap}.alex-header__nav-item--spacer{margin-left:auto;margin-right:auto}.alex-header__nav-item a,.alex-header__nav-item a:hover,.alex-header__nav-item a:visited{border-bottom:.5rem solid transparent;color:#fff;display:block;font-size:clamp(.89rem,.42vw + .74rem,1.06rem);padding:1rem;position:relative;text-decoration:none}.alex-header__nav-item a:hover,.alex-header__nav-item a:hover:hover,.alex-header__nav-item a:visited:hover{border-bottom:.5rem solid #aaa;color:#aaa!important}.alex-header__nav-item a img.large,.alex-header__nav-item a:hover img.large,.alex-header__nav-item a:visited img.large{filter:invert(1);height:1.6rem;margin:-1rem 0;padding:.25rem 0;width:1.6rem}.alex-header__nav-item--active a{border-bottom:.5rem solid #fff!important}.alex-header__intro{font-size:1rem}.alex-header__about{color:#fff;display:block;font-weight:500;padding:1em 0 0;text-align:center;width:100%}@media(min-width:769px){.alex-header__about{padding-bottom:1em;padding-top:3em}}@media(min-width:993px){.alex-header__about{padding-bottom:3em;padding-top:5em}}@media(min-width:1201px){.alex-header__about{padding-bottom:4em;padding-top:6em}}.alex-header__about .read-more{font-size:smaller;font-style:italic}.alex-header__name{color:#fff;font-size:40pt;font-weight:700;text-transform:none;white-space:nowrap}.alex-header-image:after{background-image:linear-gradient(180deg,rgba(96,92,96,.6),hsla(0,0%,8%,.6));bottom:0;content:"";left:0;position:absolute;right:0;top:0;z-index:-95}.alex-header-image__blur,.alex-header-image__main{height:100%;object-fit:cover;position:absolute;transition:opacity 1.4s linear;width:100%;z-index:-95}.alex-header-image__main{opacity:0}.alex-header-image__blur{filter:blur(100px);opacity:1;transform:scale(1.02);z-index:-100}.alex-webmentions__likes ul{list-style-type:none;padding:0}.alex-webmentions__likes ul li{display:inline}.alex-webmentions__likes img{border-radius:50% 50%;height:32px;object-fit:cover;width:32px}.alex-webmentions__reposts ul{list-style-type:none;padding:0}.alex-webmentions__reposts ul li{display:inline}.alex-webmentions__reposts img{border-radius:50% 50%;height:32px;object-fit:cover;width:32px}.footer{color:gray}.footer__social-link{filter:brightness(2);height:.8rem;width:.8rem}code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#f8f8f2;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;text-align:left;text-shadow:0 1px rgba(0,0,0,.3);white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{border-radius:.3em;margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#8292a2}.token.punctuation{color:#f8f8f2}.token.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a6e22e}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#e6db74}.token.keyword{color:#66d9ef}.token.important,.token.regex{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.command-line-prompt{border-right:1px solid #999;display:block;float:left;font-size:100%;letter-spacing:-1px;margin-right:1em;pointer-events:none;text-align:right;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.command-line-prompt>span:before{content:" ";display:block;opacity:.7;padding-right:.8em}.command-line-prompt>span[data-user]:before{content:"[" attr(data-user) "@" attr(data-host) "] $"}.command-line-prompt>span[data-user=root]:before{content:"[" attr(data-user) "@" attr(data-host) "] #"}.command-line-prompt>span[data-prompt]:before{content:attr(data-prompt)}.command-line-prompt>span[data-continuation-prompt]:before{content:attr(data-continuation-prompt)}.command-line span.token.output{opacity:.7}.alex-form,img.responsive-image{max-width:100%}.alex-form{margin:0 auto;width:90%}@media(min-width:769px){.alex-form__inline-group{box-sizing:border-box;clear:both;display:flex;display:block;display:inline-flex;flex:10 1;flex-wrap:wrap;float:left;max-width:100%;min-width:100%}.alex-form__inline-group:after,.alex-form__inline-group:before{content:"";display:table;display:flex}.alex-form__inline-group:after{clear:both}.alex-form__inline-group>:first-child,.alex-form__inline-group>:first-child:focus{border-right:0;box-sizing:border-box;display:block;flex:7 1;float:left;max-width:70%;min-width:70%}.alex-form__inline-group :last-child:focus,.alex-form__inline-group>:last-child{box-sizing:border-box;display:block;flex:3 1;float:left;max-width:30%;min-width:30%}}.alex-form__input,.alex-form__input::placeholder,.alex-form__input:focus{padding:.5em .6em}.alex-form__input,.alex-form__input:focus{border:1px solid gray;box-sizing:border-box;clear:both;display:flex;display:block;flex:10 1;flex-wrap:wrap;float:left;line-height:clamp(2rem,0vw + 2rem,2rem);margin-bottom:clamp(.33rem,.21vw + .25rem,.41rem);max-width:100%;min-width:100%;padding-top:clamp(.67rem,-.21vw + .75rem,.59rem)}.alex-form__input:after,.alex-form__input:before,.alex-form__input:focus:after,.alex-form__input:focus:before{content:"";display:table;display:flex}.alex-form__input:after,.alex-form__input:focus:after{clear:both}body,html{background-color:#fff;margin:0;padding:0}img.responsive{max-width:100%}.main-content{min-height:250px;padding-bottom:50px;text-align:center}.main-content__secondary{margin:0 auto;max-width:660px}.alex-home{margin:0 auto;max-width:1200px;width:90%}.alex-home__section{clear:both;display:flex;flex-wrap:wrap;padding-bottom:1em}.alex-home__section a,.alex-home__section a:visited{text-decoration:none}.alex-home__section:after,.alex-home__section:before{content:"";display:table;display:flex}.alex-home__section:after{clear:both}.alex-home__tilestack-item{box-sizing:border-box;display:block;flex:10 1;float:left;max-width:100%;min-width:100%}@media(min-width:577px){.alex-home__tilestack-item{box-sizing:border-box;display:block;flex:5 1;float:left;max-width:50%;min-width:50%}}@media(min-width:769px){.alex-home__tilestack-item{box-sizing:border-box;display:block;flex:3 1;float:left;max-width:30%;min-width:30%}}.alex-home__tilestack-item .alex-card{border-bottom:none}.alex-article{clear:both;display:flex;display:grid;flex-wrap:wrap;gap:0 2em;grid-template-areas:"Headline" "Main" "Aside";grid-template-columns:1fr;grid-template-rows:auto;margin:0 auto;max-width:1200px;width:90%}.alex-article:after,.alex-article:before{content:"";display:table;display:flex}.alex-article:after{clear:both}@media(min-width:769px){.alex-article{grid-template-areas:"Headline Headline" "Main Aside";grid-template-columns:8fr 2fr}}@media(min-width:993px){.alex-article{gap:0 3em;gap:0 4em;grid-template-areas:"Headline Headline" "Main Aside";grid-template-columns:7fr 3fr}}.alex-article__headline{font-size:clamp(1.75rem,1.92vw + 1.06rem,2.5rem);grid-area:Headline;line-height:clamp(3rem,0vw + 3rem,3rem);margin-bottom:clamp(.08rem,.63vw + -.15rem,.33rem);padding-top:clamp(.92rem,-.63vw + 1.15rem,.68rem)}.alex-article__main{grid-area:Main;overflow-x:auto}.alex-article__aside{display:inline-grid!important;gap:2em;grid-area:Aside;grid-template-rows:min-content auto min-content}.alex-article__aside-top{grid-row:1/3}.alex-article__aside-mid{grid-row:2/3}.alex-article__aside-bottom{grid-row:3/3}.alex-article__topics{display:none}@media(min-width:769px){.alex-article__topics{display:block}}.alex-article__topics ul{display:inline;list-style:none;margin:0;padding:0}.alex-article__topics li{display:inline}.alex-article__topics li:after{content:", "}.alex-article__topics li:last-child:after{content:"."}.alex-article__topics li:nth-last-child(2):after{content:" & "}@media(min-width:769px){.alex-article__recommended{position:sticky;top:15em}}.alex-article__recommended h2{font-size:clamp(1.12rem,.74vw + .85rem,1.41rem);text-transform:none}.alex-article__recommended h3{font-size:clamp(1rem,.64vw + .77rem,1.25rem)}.alex-article__sharing-block h3{font-size:clamp(1.12rem,.74vw + .85rem,1.41rem)}@media(max-width:767px){.alex-article__sharing-block{display:flex}.alex-article__sharing-block>div{flex:1 1}}.alex-article__image{background:no-repeat 50%;background-attachment:scroll;background-color:#ccc;background-size:cover;height:400px;margin-top:-4em}.alex-article__pane{clear:both;display:flex;flex-wrap:wrap}.alex-article__pane:after,.alex-article__pane:before{content:"";display:table;display:flex}.alex-article__pane:after{clear:both}.alex-article__pane-half{box-sizing:border-box;display:block;flex:10 1;float:left;max-width:100%;min-width:100%;padding-right:.5rem}@media(min-width:577px){.alex-article__pane-half{box-sizing:border-box;display:block;flex:5 1;float:left;max-width:50%;min-width:50%}}.alex-article__body img{max-width:100%}.alex-article__infobox{background:#dcedff;padding:1em}.alex-article__infobox .bullet--rss{list-style-image:url(/svg/rss.svg)}.alex-article__infobox .bullet--email{list-style-image:url(/svg/email.svg)}.alex-article__infobox .bullet--twitter{list-style-image:url(/svg/twitter.svg)}.alex-article__infobox .bullet--twitter::marker{font-size:1.5em}.alex-stream,.consultancy{margin:0 auto;max-width:1200px;width:90%}.consultancy{align-items:center;justify-content:center}.consultancy h1{font-size:clamp(1.75rem,1.92vw + 1.06rem,2.5rem);line-height:clamp(3rem,0vw + 3rem,3rem);margin-bottom:clamp(.08rem,.63vw + -.15rem,.33rem);padding-top:clamp(.92rem,-.63vw + 1.15rem,.68rem);text-align:center}.consultancy p{line-height:clamp(2rem,0vw + 2rem,2rem);margin-bottom:clamp(1.33rem,.21vw + 1.25rem,1.41rem);padding-top:clamp(.67rem,-.21vw + .75rem,.59rem)}.consultancy-lede{box-sizing:border-box;clear:both;display:flex;display:block;flex:10 1;flex-wrap:wrap;float:left;max-width:100%;min-width:100%;padding:1em}.consultancy-lede:after,.consultancy-lede:before{content:"";display:table;display:flex}.consultancy-lede:after{clear:both}.consultancy-service{border:1px solid #e6e6e6;clear:both;display:flex;flex-wrap:wrap;margin-bottom:1em}.consultancy-service:after,.consultancy-service:before{content:"";display:table;display:flex}.consultancy-service:after{clear:both}.consultancy-service__title{box-sizing:border-box;display:block;flex:10 1;float:left;margin-bottom:0;max-width:100%;min-width:100%;text-align:center}.consultancy-service__text{flex:8 1;line-height:clamp(2rem,0vw + 2rem,2rem);margin-bottom:clamp(1.33rem,.21vw + 1.25rem,1.41rem);max-width:80%;min-width:80%}.consultancy-service__icon,.consultancy-service__text{box-sizing:border-box;display:block;float:left;margin-top:0;padding:0 1em 1em}.consultancy-service__icon{flex:2 1;max-width:20%;min-width:20%;width:80%}.consultancy-divider{padding:1em 0}.consultancy-contact{clear:both;display:flex;flex-wrap:wrap}.consultancy-contact:after,.consultancy-contact:before{content:"";display:table;display:flex}.consultancy-contact:after{clear:both}.consultancy-contact form{box-sizing:border-box;display:block;flex:10 1;float:left;max-width:100%;min-width:100%}@media(min-width:577px){.consultancy-contact form{box-sizing:border-box;display:block;flex:6 1;float:left;max-width:60%;min-width:60%}}.consultancy-footer{align-content:center;justify-content:center;margin:0 auto;max-width:100%;width:90%}.consultancy-footer div{box-sizing:border-box;clear:both;display:flex;display:block;flex:10 1;flex-wrap:wrap;float:left;font-size:clamp(.89rem,.42vw + .74rem,1.06rem);line-height:clamp(2rem,0vw + 2rem,2rem);margin-bottom:clamp(-.71rem,.14vw + -.75rem,-.65rem);max-width:100%;min-width:100%;padding-top:clamp(.71rem,-.14vw + .75rem,.65rem);text-align:center}.consultancy-footer div:after,.consultancy-footer div:before{content:"";display:table;display:flex}.consultancy-footer div:after{clear:both}code[class*=language-] span,pre[class*=language-] span{font-family:inherit}.panel{background:#1a8cff}.panel-default{border-color:#feeddd}hr{border:0;border-top:1px solid #000}.embed-container{height:0;max-width:100%;overflow:hidden;padding-bottom:56.25%;position:relative}.embed-container embed,.embed-container iframe,.embed-container object{height:100%;left:0;position:absolute;top:0;width:100%}html{-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;font-size:100%}body{font-family:Georgia,serif;font-size:clamp(1rem,.64vw + .77rem,1.25rem);font-style:normal;font-weight:400;line-height:2rem}a{color:#333;text-decoration:none;transition:color .1s,background-color .1s}a:active,a:focus,a:hover{color:gray;text-decoration:none}.alex-article__body li a,.alex-article__body p a,.typeset li a,.typeset p a{background-image:linear-gradient(180deg,transparent 50%,#666 0);background-position:0 93%;background-repeat:repeat-x;background-size:100% .15rem;font-family:Georgia,serif;text-shadow:.1rem 0 #fcfcfc,.15rem 0 #fcfcfc,-.1rem 0 #fcfcfc,-.15rem 0 #fcfcfc}.alex-article__body li a:active,.alex-article__body li a:focus,.alex-article__body li a:hover,.alex-article__body p a:active,.alex-article__body p a:focus,.alex-article__body p a:hover,.typeset li a:active,.typeset li a:focus,.typeset li a:hover,.typeset p a:active,.typeset p a:focus,.typeset p a:hover{background-image:linear-gradient(180deg,transparent 50%,#b3b3b3 0)}.alex-article__body p,.typeset p{font-feature-settings:"kern","onum","liga";font-family:Georgia,serif;line-height:clamp(2rem,0vw + 2rem,2rem);margin-bottom:clamp(1.33rem,.21vw + 1.25rem,1.41rem);padding-top:clamp(.67rem,-.21vw + .75rem,.59rem)}.alex-article__body h1,.alex-article__body h2,.alex-article__body h3,.alex-article__body h4,.alex-article__body h5,.alex-article__body h6,.typeset h1,.typeset h2,.typeset h3,.typeset h4,.typeset h5,.typeset h6{font-feature-settings:"dlig","liga","lnum","kern";color:#2e2e2e;font-family:Helvetica,sans-serif;font-style:normal;font-weight:700}.alex-article__body .alpha,.alex-article__body h1,.typeset .alpha,.typeset h1{font-size:clamp(1.75rem,1.92vw + 1.06rem,2.5rem);line-height:clamp(3rem,0vw + 3rem,3rem);margin-bottom:clamp(.08rem,.63vw + -.15rem,.33rem);padding-top:clamp(.92rem,-.63vw + 1.15rem,.68rem)}.alex-article__body .beta,.alex-article__body h2,.typeset .beta,.typeset h2{font-size:clamp(1.56rem,1.68vw + .96rem,2.22rem);line-height:clamp(3rem,0vw + 3rem,3rem);margin-bottom:clamp(.02rem,.56vw + -.18rem,.23rem);padding-top:clamp(.98rem,-.56vw + 1.18rem,.77rem)}.alex-article__body .gamma,.alex-article__body h3,.typeset .gamma,.typeset h3{font-size:clamp(1.4rem,1.22vw + .96rem,1.88rem);line-height:clamp(3rem,0vw + 3rem,3rem);margin-bottom:clamp(-.04rem,.4vw + -.18rem,.12rem);padding-top:clamp(1.04rem,-.4vw + 1.18rem,.88rem)}.alex-article__body .delta,.alex-article__body h4,.typeset .delta,.typeset h4{font-size:clamp(1.25rem,1.07vw + .86rem,1.67rem);line-height:clamp(2rem,0vw + 2rem,2rem);margin-bottom:clamp(-.59rem,.35vw + -.72rem,-.45rem);padding-top:clamp(.59rem,-.35vw + .72rem,.45rem)}.alex-article__body .epsilon,.alex-article__body h5,.typeset .epsilon,.typeset h5{font-size:clamp(1.12rem,.74vw + .85rem,1.41rem);line-height:clamp(2rem,0vw + 2rem,2rem);margin-bottom:clamp(-.63rem,.24vw + -.72rem,-.54rem);padding-top:clamp(.63rem,-.24vw + .72rem,.54rem)}.alex-article__body .zeta,.alex-article__body h6,.typeset .zeta,.typeset h6{font-size:clamp(1rem,.64vw + .77rem,1.25rem);line-height:clamp(2rem,0vw + 2rem,2rem);margin-bottom:clamp(-.67rem,.21vw + -.75rem,-.59rem);padding-top:clamp(.67rem,-.21vw + .75rem,.59rem)}.alex-article__body .eta,.typeset .eta{font-size:clamp(.89rem,.42vw + .74rem,1.06rem);line-height:clamp(2rem,0vw + 2rem,2rem);margin-bottom:clamp(-.71rem,.14vw + -.75rem,-.65rem);padding-top:clamp(.71rem,-.14vw + .75rem,.65rem)}.alex-article__body .theta,.typeset .theta{font-size:clamp(.8rem,.35vw + .67rem,.94rem);line-height:clamp(2rem,0vw + 2rem,2rem);margin-bottom:clamp(-.74rem,.12vw + -.78rem,-.69rem);padding-top:clamp(.74rem,-.12vw + .78rem,.69rem)}.alex-article__body .iota,.typeset .iota{font-size:clamp(.72rem,.19vw + .65rem,.79rem);line-height:clamp(2rem,0vw + 2rem,2rem);margin-bottom:clamp(-.76rem,.06vw + -.79rem,-.74rem);padding-top:clamp(.76rem,-.06vw + .79rem,.74rem)}.alex-article__body ol,.alex-article__body ul,.typeset ol,.typeset ul{line-height:clamp(2rem,0vw + 2rem,2rem);margin-bottom:clamp(1.33rem,.21vw + 1.25rem,1.41rem);padding-top:clamp(.67rem,-.21vw + .75rem,.59rem)}.alex-article__body ol li,.alex-article__body ul li,.typeset ol li,.typeset ul li{font-feature-settings:"kern","onum","liga";font-family:Georgia,serif;margin-left:1rem}.alex-article__body ol li p,.alex-article__body ul li p,.typeset ol li p,.typeset ul li p{display:inline}@media(min-width:577px){.alex-article__body ol li,.alex-article__body ul li,.typeset ol li,.typeset ul li{margin-left:0}}.alex-article__body ol li ol,.alex-article__body ol li ul,.alex-article__body ul li ol,.alex-article__body ul li ul,.typeset ol li ol,.typeset ol li ul,.typeset ul li ol,.typeset ul li ul{margin-bottom:1rem;margin-left:1rem;padding-top:1rem}.alex-article__body ol,.typeset ol{list-style-type:none}.alex-article__body ol li,.typeset ol li{counter-increment:top-level}.alex-article__body ol li:before,.typeset ol li:before{font-feature-settings:"lnum","tnum";content:counter(top-level) ".";margin-left:-3rem;position:absolute;text-align:right;width:1em}.alex-article__body ol li ul li:before,.typeset ol li ul li:before{content:""}.alex-article__body ol li ul li ol li,.typeset ol li ul li ol li{counter-increment:alt-level}.alex-article__body ol li ul li ol li:before,.typeset ol li ul li ol li:before{content:counter(alt-level) "."}.alex-article__body ol li ol li,.typeset ol li ol li{counter-increment:sub-level}.alex-article__body ol li ol li:before,.typeset ol li ol li:before{content:counter(top-level) "." counter(sub-level)}.alex-article__body ol li ol li ul li:before,.typeset ol li ol li ul li:before{content:""}.alex-article__body ol li ol li ol li,.typeset ol li ol li ol li{counter-increment:sub-sub-level}.alex-article__body ol li ol li ol li:before,.typeset ol li ol li ol li:before{content:counter(top-level) "." counter(sub-level) "." counter(sub-sub-level)}.alex-article__body dl,.typeset dl{line-height:clamp(2rem,0vw + 2rem,2rem);margin-bottom:clamp(1.33rem,.21vw + 1.25rem,1.41rem);padding-top:clamp(.67rem,-.21vw + .75rem,.59rem)}.alex-article__body dl dd,.alex-article__body dl dt,.typeset dl dd,.typeset dl dt{font-feature-settings:"kern","onum","liga";margin-left:2rem}@media(min-width:577px){.alex-article__body dl dd,.alex-article__body dl dt,.typeset dl dd,.typeset dl dt{margin-left:0}}.alex-article__body dl dt,.typeset dl dt{font-weight:700}.alex-article__body dl dd+dt,.typeset dl dd+dt{padding-top:1rem}.alex-article__body table,.typeset table{font-feature-settings:"liga","lnum","tnum","kern";font-family:Helvetica,sans-serif;font-size:clamp(.89rem,.42vw + .74rem,1.06rem);font-style:normal;font-weight:400;line-height:clamp(2rem,0vw + 2rem,2rem);margin-bottom:clamp(-.71rem,.14vw + -.75rem,-.65rem);padding-top:clamp(.71rem,-.14vw + .75rem,.65rem);width:100%}.alex-article__body table thead th,.typeset table thead th{font-size:clamp(1rem,.64vw + .77rem,1.25rem);line-height:clamp(2rem,0vw + 2rem,2rem);margin-bottom:clamp(-.67rem,.21vw + -.75rem,-.59rem);padding-bottom:1px;padding-top:clamp(.67rem,-.21vw + .75rem,.59rem)}.alex-article__body .bold,.alex-article__body b,.alex-article__body strong,.typeset .bold,.typeset b,.typeset strong{font-family:Georgia,serif;font-weight:700}.alex-article__body .italic,.alex-article__body em,.alex-article__body i,.typeset .italic,.typeset em,.typeset i{font-family:Georgia,serif;font-style:italic}.alex-article__body .caption,.alex-article__body small,.typeset .caption,.typeset small{font-family:Helvetica,sans-serif;font-size:clamp(.8rem,.35vw + .67rem,.94rem);font-style:normal;font-weight:400}.alex-article__body small,.typeset small{line-height:1rem}.alex-article__body .caption,.typeset .caption{color:#bdc8cc;line-height:clamp(2rem,0vw + 2rem,2rem);margin-bottom:clamp(1.26rem,.12vw + 1.22rem,1.31rem);padding-top:clamp(.74rem,-.12vw + .78rem,.69rem)}.alex-article__body .alpha+.caption,.alex-article__body .beta+.caption,.alex-article__body .gamma+.caption,.alex-article__body h1+.caption,.alex-article__body h2+.caption,.alex-article__body h3+.caption,.typeset .alpha+.caption,.typeset .beta+.caption,.typeset .gamma+.caption,.typeset h1+.caption,.typeset h2+.caption,.typeset h3+.caption{margin-top:-1rem}.alex-article__body .delta+.caption,.alex-article__body .epsilon+.caption,.alex-article__body .zeta+.caption,.typeset .delta+.caption,.typeset .epsilon+.caption,.typeset .zeta+.caption{margin-top:0}.alex-article__body blockquote p,.typeset blockquote p{border-left:.15rem solid #333;font-style:italic;line-height:clamp(2rem,0vw + 2rem,2rem);margin-bottom:clamp(1.33rem,.21vw + 1.25rem,1.41rem);padding-left:1rem;padding-top:clamp(.67rem,-.21vw + .75rem,.59rem)}@media(min-width:577px){.alex-article__body blockquote,.typeset blockquote{margin-left:-1rem}}.alex-article__body hr,.typeset hr{background-image:linear-gradient(180deg,transparent 50%,#bdc8cc 0);background-position:0 50%;background-repeat:repeat-x;background-size:100% .15rem;border:0;margin:0;padding-bottom:3rem;padding-top:3rem}.alex-article__body .upper,.typeset .upper{font-kerning:normal;letter-spacing:.1rem;text-transform:uppercase}.alex-article__body .small-caps,.typeset .small-caps{font-feature-settings:"smcp","kern";font-kerning:normal;letter-spacing:.1rem}.alex-article__body .lining-numerals,.typeset .lining-numerals{font-feature-settings:"lnum","kern"}.alex-article__body .oldstyle-numerals,.typeset .oldstyle-numerals{font-feature-settings:"onum","kern"}*{font-family:Avenir Next,Avenir,Arial,sans-serif}.alex-article__body ol li:not(:last-child),.alex-article__body ul li:not(:last-child){padding-bottom:1em}.alex-article__byline{padding-bottom:5px}.wf-active .heading{font-family:Overpass,sans-serif}.heading a,.heading a:visited{color:#333}.align-left{text-align:left}.align-right{text-align:right}.align-center{text-align:center}h1,h2,h3,h4,ul.pager,ul.pagination{color:#333}.wf-active h1,.wf-active h2,.wf-active h3,.wf-active h4,.wf-active ul.pager,.wf-active ul.pagination{font-family:Overpass,sans-serif}h1,h2{text-transform:uppercase}a,a:focus,a:hover,a:visited{text-decoration:underline;transition:color .4s ease-out,background .2s ease-in}.text--small{font-size:clamp(.72rem,.19vw + .65rem,.79rem)}.spacer{font-size:60px;line-height:20px;margin:0;position:relative;top:-35px}.alex-card{border-bottom:1px solid #000;display:flex;margin-bottom:1em;padding-bottom:1em;padding-right:1em}.alex-card a,.alex-card a:active,.alex-card a:visited{text-decoration:none}.alex-card a:hover{text-decoration:underline}.alex-card__content--container{flex:3 1}.alex-card__media--container{flex:1 1;padding:1em 0 1em 1em}.alex-card__title h3{margin:0}.alex-card__abstract p{margin:.5em 0}.alex-card__image{flex:1 1;margin-left:1em;margin-right:-1em;margin-top:1em}.alex-card__image img{display:block;height:auto;max-width:100%;min-height:100px;padding-right:0}</style><title data-react-helmet="true">Deploying static sites with Github Actions - Alex Wilson</title><link data-react-helmet="true" rel="alternate" type="application/rss+xml" title="Alex Wilson&#x27;s writing via RSS" href="/feed.xml"/><link data-react-helmet="true" rel="webmention" href="https://webmention.io/alexwilson.tech/webmention"/><link data-react-helmet="true" rel="pingback" href="https://webmention.io/alexwilson.tech/xmlrpc"/><script data-react-helmet="true" type="application/ld+json">{"@type":"WebPage","@context":"http://schema.org","name":"Alex Wilson","description":"Software Engineer, Technical Architect — Helping build a better, faster internet.","copyrightHolder":{"@type":"Person","name":"Alex","memberOf":{"@type":"Organization","@context":"http://schema.org","name":"Alex Wilson","logo":{"@type":"ImageObject","@context":"http://schema.org","url":"https://avatars.githubusercontent.com/u/440052","width":460,"height":460},"url":"https://alexwilson.tech","sameAs":["https://www.twitter.com/AlexWilsonV1","https://www.linkedin.com/in/alex-","https://github.com/alexwilson"]},"givenName":"Alex","familyName":"Wilson"},"publisher":{"@type":"Organization","@context":"http://schema.org","name":"Alex Wilson","logo":{"@type":"ImageObject","@context":"http://schema.org","url":"https://avatars.githubusercontent.com/u/440052","width":460,"height":460},"url":"https://alexwilson.tech","sameAs":["https://www.twitter.com/AlexWilsonV1","https://www.linkedin.com/in/alex-","https://github.com/alexwilson"]}}</script><script data-react-helmet="true" type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://alexwilson.tech/content/717e6a35-1cb5-4a28-9321-592d05ddd9dc"},"url":"https://alexwilson.tech/content/717e6a35-1cb5-4a28-9321-592d05ddd9dc","headline":"Deploying static sites with Github Actions","dateModified":"2020-01-15T00:00:00.000Z","datePublished":"2020-01-15T00:00:00.000Z","publisher":{"@type":"Organization","@context":"http://schema.org","name":"Alex Wilson","logo":{"@type":"ImageObject","@context":"http://schema.org","url":"https://avatars.githubusercontent.com/u/440052","width":460,"height":460},"url":"https://alexwilson.tech","sameAs":["https://www.twitter.com/AlexWilsonV1","https://www.linkedin.com/in/alex-","https://github.com/alexwilson"]},"author":{"@type":"Person","name":"Alex","memberOf":{"@type":"Organization","@context":"http://schema.org","name":"Alex Wilson","logo":{"@type":"ImageObject","@context":"http://schema.org","url":"https://avatars.githubusercontent.com/u/440052","width":460,"height":460},"url":"https://alexwilson.tech","sameAs":["https://www.twitter.com/AlexWilsonV1","https://www.linkedin.com/in/alex-","https://github.com/alexwilson"]},"givenName":"Alex","familyName":"Wilson"},"image":null,"description":"First, some background: Github Pages is a brilliant way to build static websites quickly and easily. However it is quite\nlimited as it only…"}</script><link href="https://github.githubassets.com/assets/gist-embed-b3b573358bfc66d89e1e95dbf8319c09.css" rel="stylesheet"/><link rel="sitemap" type="application/xml" href="/sitemap-index.xml"/><link rel="alternate" type="application/rss+xml" title="Alex Wilson&#x27;s writing" href="/feed.xml"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><header role="banner" class="alex-header"><div class="alex-header-image"><picture class="alex-header-image--container"><img alt="Header" class="alex-header-image__blur"/><img alt="Header" class="alex-header-image__main" style="opacity:0"/></picture></div><div class="alex-header--container"><div class="alex-header__about"><h1 class="alex-header__name">Alex Wilson</h1><span class="alex-header__intro">On products, engineering &amp; everything in-between.</span></div><nav class="alex-header__nav--container"><a class="alex-header__menu-button" role="button" aria-pressed="false"><span></span><span></span><span></span></a><ul class="alex-header__nav" id="menu" aria-expanded="false"><li class="alex-header__nav-item"><a href="/">Home</a></li><li class="alex-header__nav-item"><a href="/about-me">About Me</a></li><li class="alex-header__nav-item alex-header__nav-item--active"><a href="/blog">Writing</a></li><li class="alex-header__nav-item"><a href="/talks">Speaking</a></li><li class="alex-header__nav-item"><a href="/consultancy">Hire Me</a></li><li class="alex-header__nav-item alex-header__nav-item--spacer"></li><li class="alex-header__nav-item"><a href="https://mastodon.social/@alexwilson" rel="me"><img src="/svg/mastodon.svg" alt="Mastodon" class="large" height="1em"/></a></li><li class="alex-header__nav-item"><a href="https://twitter.com/alexwilsonv1" rel="me"><img src="/svg/twitter.svg" alt="Twitter" class="large" height="1em"/></a></li><li class="alex-header__nav-item"><a href="https://www.linkedin.com/in/alex-/" rel="me"><img src="/svg/linkedin.svg" alt="LinkedIn" class="large" height="1em"/></a></li><li class="alex-header__nav-item"><a href="https://github.com/alexwilson" rel="me"><img src="/svg/github.svg" alt="Github" class="large" height="1em"/></a></li></ul></nav></div></header><main><div class="alex-article"><h1 class="alex-article__headline" itemProp="name headline">Deploying static sites with Github Actions</h1><div class="alex-article__main"><div class="alex-article__byline">Posted<!-- --> by <span itemProp="author" itemType="http://schema.org/Person"><a href="/"><span itemProp="name">Alex</span></a></span> on <time class="alex-article__main__date" dateTime="Wed Jan 15 2020 00:00:00 GMT+0000 (Coordinated Universal Time)" itemProp="datePublished">Wednesday, January 15th, 2020</time>.</div><article class="alex-article__body article-description" itemProp="articleBody"><p>First, some background:</p>
<p>Github Pages is a brilliant way to build static websites quickly and easily. However it is quite
limited as it only runs Jekyll, which is in safe mode — meaning only template customisations were
possible.  Last year after growing frustrated with hacking together template-driven functionality
like RSS feeds and article recommendations, I replatformed to Gatsby.</p>
<p>Porting was relatively straightforward and has brought a swathe of benefits including pluggable APIs
and the ability to write unit tests, but it also introduced a new problem: I didn't have a way of
deploying the site.</p>
<p>Exploring my options, pairing Github Actions (to build) with Github Pages (to host) seemed rather
attractive as:</p>
<ul>
<li>Actions have tight integration with Github allowing me to keep my workflows in one place. Other
CI/CD offerings added extra overhead.</li>
<li>Actions seemed customisable enough to implement Github Pages again with minimal overhead.</li>
<li>If anything happens to Actions or Pages, both are simple enough that migrating to something else
is realistic.</li>
</ul>
<p>These all proved to be true, and I was able to quickly put together something quite usable.
A few months of small tweaks and one refactor later, I am happy enough to talk about what I did.</p>
<h2>Building a workflow in Github Actions</h2>
<p>Github Actions is still relatively new so there's not a lot of documentation out there.</p>
<p>In order to start with writing a Github Actions script, there are three things we need to know.</p>
<ol>
<li>What it is called, with the <code class="language-text">name</code> key.</li>
<li>When to run this action, with the <code class="language-text">on</code> key.</li>
<li>What it will do, with the <code class="language-text">jobs</code> key.</li>
</ol>
<p>Starting with the simplest, the name, I called my workflow "Build, Test and Deploy".</p>
<div class="gatsby-highlight" data-language="yaml"><pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">name</span><span class="token punctuation">:</span> Build<span class="token punctuation">,</span> Test and Deploy</code></pre></div>
<p>Next, I wanted this to run for all branches.  An important note is that <strong>Github Actions will not
trigger for pushes that it performs</strong>, so while I have excluded the <code class="language-text">gh-pages</code> branch here, this
was more for readability than to prevent unexpected behaviour.</p>
<div class="gatsby-highlight" data-language="yaml"><pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">on</span><span class="token punctuation">:</span>
  <span class="token key atrule">push</span><span class="token punctuation">:</span>
    <span class="token key atrule">branches</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">'!gh-pages'</span>
      <span class="token punctuation">-</span> <span class="token string">'*'</span></code></pre></div>
<p>Lastly, we can start defining some jobs. Each has a unique ID which is also its key in the jobs block,
and a <code class="language-text">name</code> key which is used the UI.</p>
<p>I kept this simple, and required each step to wait for the previous one to succeed with the <code class="language-text">needs</code> key.
We can choose a task-runner using the <code class="language-text">runs-on</code> key, I opted for <code class="language-text">ubuntu-latest</code> for simplicity.</p>
<div class="gatsby-highlight" data-language="yaml"><pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">build</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> Build
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
  <span class="token key atrule">test</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> Test
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
    <span class="token key atrule">needs</span><span class="token punctuation">:</span> build
  <span class="token key atrule">deploy</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> Deploy
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
    <span class="token key atrule">needs</span><span class="token punctuation">:</span> deploy</code></pre></div>
<p>Putting this all together, we now have a skeleton workflow which we can customise to our needs. Here
I've also added a checkout step to the <code class="language-text">build</code> job.</p>
<div class="gatsby-highlight" data-language="yaml"><pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">name</span><span class="token punctuation">:</span> Build<span class="token punctuation">,</span> Test and Deploy
<span class="token key atrule">on</span><span class="token punctuation">:</span>
  <span class="token key atrule">push</span><span class="token punctuation">:</span>
    <span class="token key atrule">branches</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">'!gh-pages'</span>
      <span class="token punctuation">-</span> <span class="token string">'*'</span>
<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">build</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> Build
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Checkout Code
      <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@master
  <span class="token key atrule">test</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> Test
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
    <span class="token key atrule">needs</span><span class="token punctuation">:</span> build
  <span class="token key atrule">deploy</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> Deploy
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
    <span class="token key atrule">needs</span><span class="token punctuation">:</span> deploy</code></pre></div>
<h2>Building</h2>
<p>Focusing specifically on the <code class="language-text">build</code> job, we can now add a few steps to perform the
build process, so that we can later on test it and deploy it.
Our input is our source-code and our output is a build artifact.</p>
<p>I've commented inline.</p>
<div class="gatsby-highlight" data-language="yaml"><pre class="language-yaml"><code class="language-yaml">  <span class="token key atrule">build</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> Build
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>

    <span class="token comment"># Firstly, let's check-out our code.</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Checkout Code
      <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@master

    <span class="token comment"># Now let's configure this environment to support NodeJS tooling.</span>
    <span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/setup<span class="token punctuation">-</span>node@master

    <span class="token comment"># Now run an npm install...</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Install Dependencies
      <span class="token key atrule">run</span><span class="token punctuation">:</span> npm install

    <span class="token comment"># Run the build-script, which is a package.json script in this case.</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Build
      <span class="token key atrule">run</span><span class="token punctuation">:</span> npm run build
      <span class="token key atrule">env</span><span class="token punctuation">:</span>
        <span class="token key atrule">CI</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment"># This is done to prevent output being too verbose.</span>

    <span class="token comment"># Use Github's upload-artifact action to upload our hopefully-successful build!</span>
    <span class="token comment"># We only want the `public` folder here which contains our (optimised) static site.</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Save Build Artifact
      <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/upload<span class="token punctuation">-</span>artifact@v1
      <span class="token key atrule">with</span><span class="token punctuation">:</span>
        <span class="token key atrule">name</span><span class="token punctuation">:</span> site<span class="token punctuation">-</span>artifact <span class="token comment"># A unique key (and name) for the artifact in question.</span>
        <span class="token key atrule">path</span><span class="token punctuation">:</span> public        <span class="token comment"># This is what we'd like to keep, we want `public` but any file/folder works.</span></code></pre></div>
<p>Awesome! Now we have a workflow which builds and saves an artifact, which is actually downloadable
from the Github UI.</p>
<h2>Testing</h2>
<p>Now that the site is being built, let's add a few steps to the test workflow to run some tests.
Our input is our source code, our build artifact. We don't return anything, but we do throw an error
if any tests fail.</p>
<div class="gatsby-highlight" data-language="yaml"><pre class="language-yaml"><code class="language-yaml">  <span class="token key atrule">test</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> Test
    <span class="token key atrule">needs</span><span class="token punctuation">:</span> build
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>

    <span class="token comment"># Again, we check-out our code.</span>
    <span class="token comment"># This is needed as we will be executing tests which are outside of the artifact.</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Checkout
      <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@master

    <span class="token comment"># Next up, we download the pre-built artifact.</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Download Website Artifact
      <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/download<span class="token punctuation">-</span>artifact@v1
      <span class="token key atrule">with</span><span class="token punctuation">:</span>
        <span class="token key atrule">name</span><span class="token punctuation">:</span> site<span class="token punctuation">-</span>artifact <span class="token comment"># We reference the original artifact name.</span>
        <span class="token key atrule">path</span><span class="token punctuation">:</span> public        <span class="token comment"># and instruct that the artifact is restored to the `public` folder.</span>

    <span class="token comment"># Configure node and reinstall dependencies (each task has a unique workspace!)</span>
    <span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/setup<span class="token punctuation">-</span>node@master
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Install Dependencies
      <span class="token key atrule">run</span><span class="token punctuation">:</span> npm install

    <span class="token comment"># Finally run our tests. The output can be tweaked so Github Actions better understands it.</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Run Tests
      <span class="token key atrule">run</span><span class="token punctuation">:</span> npm test</code></pre></div>
<p>This can absolutely be done inside the build step to save time — I kept them separate to enable
adding end-to-end tests and a few other tools which are irrelevant to the actual build process.</p>
<h2>Deploying</h2>
<p>Now that we've built and tested an artifact, we're finally ready to deploy it. This time things are
a little bit trickier, and we're going to break out into a custom action.</p>
<div class="gatsby-highlight" data-language="yaml"><pre class="language-yaml"><code class="language-yaml">  <span class="token comment"># Deploy to Github Pages environment</span>
  <span class="token key atrule">deploy-production</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> Deploy to Production
    <span class="token key atrule">needs</span><span class="token punctuation">:</span> test
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest

    <span class="token comment"># I've added this extra step, so that this task *only* runs on the master branch.</span>
    <span class="token comment"># This syntax is quite expressive and allows for much richer conditions.</span>
    <span class="token key atrule">if</span><span class="token punctuation">:</span> github.ref == 'refs/heads/master'
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>

    <span class="token comment"># Again we check-out.  This time as we'll be referencing a custom action!</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Checkout
      <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@master

    <span class="token comment"># And again, we download the website artifact. This time so we can deploy it!</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Download Website Artifact
      <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/download<span class="token punctuation">-</span>artifact@v1
      <span class="token key atrule">with</span><span class="token punctuation">:</span>
        <span class="token key atrule">name</span><span class="token punctuation">:</span> site<span class="token punctuation">-</span>artifact
        <span class="token key atrule">path</span><span class="token punctuation">:</span> public

    <span class="token comment"># A custom action!  I'll explain a bit more about this below.</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Deploy to Github Pages
      <span class="token key atrule">uses</span><span class="token punctuation">:</span> ./.github/actions/github<span class="token punctuation">-</span>pages/
      <span class="token key atrule">env</span><span class="token punctuation">:</span>
        <span class="token key atrule">GITHUB_TOKEN</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> secrets.GITHUB_TOKEN <span class="token punctuation">}</span><span class="token punctuation">}</span>
      <span class="token key atrule">with</span><span class="token punctuation">:</span>
        <span class="token key atrule">args</span><span class="token punctuation">:</span> public</code></pre></div>
<p>So now let's look at how we can push to the Github Pages branch of this current repository</p>
<p>This operation takes place primarily in Git, and luckily we have enough information available to us
to be able to find and push to Github's HTTP Git endpoint. As we're deploying an artifact each time
we don't have access to the existing Git history, so let's go ahead and create a new repository and
push it every time.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/sh</span>
<span class="token builtin class-name">set</span> <span class="token parameter variable">-e</span>

<span class="token comment"># Here we take an argument to choose which folder we release.</span>
<span class="token builtin class-name">cd</span> <span class="token variable">$*</span>

<span class="token builtin class-name">echo</span> <span class="token string">"Deploying <span class="token variable">${GITHUB_SHA}</span> to GitHub Pages"</span>
<span class="token assign-left variable">REPOSITORY</span><span class="token operator">=</span><span class="token string">"https://x-access-token:<span class="token variable">${GITHUB_TOKEN}</span>@github.com/<span class="token variable">${GITHUB_REPOSITORY}</span>.git"</span>

<span class="token comment">## Create a new repository and reference this one, with an HTTP token.</span>
<span class="token function">git</span> init
<span class="token function">git</span> remote <span class="token function">add</span> origin <span class="token variable">$REPOSITORY</span>

<span class="token comment">## Checkout the gh-pages branch, and reset to the latest version.</span>
<span class="token function">git</span> checkout <span class="token parameter variable">-b</span> gh-pages

<span class="token comment">## Configure Git to perform the commit as the user who triggered this action.</span>
<span class="token comment">## If the build wasn't triggered by a human this will be the person who last committed to the branch</span>
<span class="token function">git</span> config user.name <span class="token string">"<span class="token variable">${GITHUB_ACTOR}</span>"</span>
<span class="token function">git</span> config user.email <span class="token string">"<span class="token variable">${GITHUB_ACTOR}</span>@users.noreply.github.com"</span>

<span class="token comment">## Finally, add the contents of our script</span>
<span class="token function">git</span> <span class="token function">add</span> <span class="token builtin class-name">.</span>
<span class="token function">git</span> commit <span class="token parameter variable">-m</span> <span class="token string">"Deploying <span class="token variable">${GITHUB_SHA}</span> to Github Pages"</span>

<span class="token comment">## And force push to the gh-pages branch so Github Pages can serve it!</span>
<span class="token function">git</span> push <span class="token parameter variable">--force</span> origin gh-pages:gh-pages
<span class="token function">rm</span> <span class="token parameter variable">-fr</span> .git
<span class="token builtin class-name">cd</span> <span class="token variable">$GITHUB_WORKSPACE</span>

<span class="token builtin class-name">echo</span> <span class="token string">"Successfully deployed."</span></code></pre></div>
<p>Lastly, to be able to use this custom shell script we wrap it in a basic Dockerfile including Git
and minimal boilerplate to make it usable as a custom action.</p>
<div class="gatsby-highlight" data-language="dockerfile"><pre class="language-dockerfile"><code class="language-dockerfile"><span class="token comment"># We use the alpine git image as it's the smallest for what we need.</span>
<span class="token instruction"><span class="token keyword">FROM</span> alpine/git:latest</span>

<span class="token comment"># Github actions use a few Docker labels for interacting with custom actions.</span>
<span class="token instruction"><span class="token keyword">LABEL</span> <span class="token string">"maintainer"</span>=<span class="token string">"Alex Wilson &lt;alex@alexwilson.tech>"</span></span>
<span class="token instruction"><span class="token keyword">LABEL</span> <span class="token string">"com.github.actions.name"</span>=<span class="token string">"GitHub Pages Deploy"</span></span>
<span class="token instruction"><span class="token keyword">LABEL</span> <span class="token string">"com.github.actions.description"</span>=<span class="token string">"Deploy to GitHub Pages."</span></span>
<span class="token instruction"><span class="token keyword">LABEL</span> <span class="token string">"com.github.actions.icon"</span>=<span class="token string">"upload-cloud"</span></span>
<span class="token instruction"><span class="token keyword">LABEL</span> <span class="token string">"com.github.actions.color"</span>=<span class="token string">"blue"</span></span>

<span class="token comment"># The most important bit other than the parent image is this: We add the below script</span>
<span class="token comment"># to actually do the Github Pages deploy step and make it the entrypoint.</span>
<span class="token instruction"><span class="token keyword">ADD</span> entrypoint.sh /entrypoint.sh</span>
<span class="token instruction"><span class="token keyword">ENTRYPOINT</span> [<span class="token string">"/entrypoint.sh"</span>]</span></code></pre></div>
<h2>Deploying - Letting Github Pages know</h2>
<p>Well, unfortunately that wasn't enough.  Even though we've pushed to the <code class="language-text">gh-pages</code> branch, Github
won't do anything because we <em>pushed</em> this using Github Actions.  Remember that I said that Actions
won't trigger itself to prevent a circular dependency?  Well this is <em>that</em> protection in action.</p>
<p>Thankfully, we can mitigate this by using the Github Pages API.  We use it to queue another Pages
build as our final deployment step.</p>
<div class="gatsby-highlight" data-language="yaml"><pre class="language-yaml"><code class="language-yaml">    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Trigger a Pages Update
      <span class="token key atrule">run</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
        curl -sS -X POST -H "Authorization: Bearer ${{ secrets.GITHUB_PAGES_DEPLOY_TOKEN }}" \
        https://api.github.com/repos/${{ github.repository }}/pages/builds \</span></code></pre></div>
<p>There is a new prerequisite - we now need to add the <code class="language-text">GITHUB_PAGES_DEPLOY_TOKEN</code> environment variable,
with a new Personal Access Token which has Repository scopes.</p>
<h2>Optimising the whole thing</h2>
<p>You may have noticed that we're repeatedly reinstalling dependencies which is a little bit wasteful.
Thankfully, as well as artifact support, Github Actions also offer us a caching mechanism which we can
to speed this up.</p>
<p>It's important to mention that Github only keeps the cache alive for a maximum of 7 days since the last
build, but if you build at least a week this won't be an issue.</p>
<div class="gatsby-highlight" data-language="yaml"><pre class="language-yaml"><code class="language-yaml">    <span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/setup<span class="token punctuation">-</span>node@master

    <span class="token comment"># Store NPM's global cache, using the package-lock.json our cache key.</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Restore NPM Cache
      <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/cache@v1
      <span class="token key atrule">id</span><span class="token punctuation">:</span> cache<span class="token punctuation">-</span>npm
      <span class="token key atrule">with</span><span class="token punctuation">:</span>
        <span class="token key atrule">path</span><span class="token punctuation">:</span> ~/.npm
        <span class="token key atrule">key</span><span class="token punctuation">:</span> npm<span class="token punctuation">-</span>$<span class="token punctuation">{</span><span class="token punctuation">{</span> hashFiles('<span class="token important">**/package-lock.json')</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>

    <span class="token comment"># And the same for node_modules, using the package-lock.json our cache key.</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Restore node_modules
      <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/cache@v1
      <span class="token key atrule">id</span><span class="token punctuation">:</span> cache<span class="token punctuation">-</span>node_modules
      <span class="token key atrule">with</span><span class="token punctuation">:</span>
        <span class="token key atrule">path</span><span class="token punctuation">:</span> node_modules
        <span class="token key atrule">key</span><span class="token punctuation">:</span> node_modules<span class="token punctuation">-</span>$<span class="token punctuation">{</span><span class="token punctuation">{</span> hashFiles('<span class="token important">**/package-lock.json')</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre></div>
<p>We're also able to tweak the <code class="language-text">checkout</code> step to speed it up a bit, by adding the shallow clone directive.
After-all, we are not interacting with the project history here — we're only building it.</p>
<div class="gatsby-highlight" data-language="yaml"><pre class="language-yaml"><code class="language-yaml">    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Checkout
      <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@master
      <span class="token key atrule">with</span><span class="token punctuation">:</span>
        <span class="token key atrule">fetch-depth</span><span class="token punctuation">:</span> <span class="token number">1</span></code></pre></div>
<h2>Adding history and rollbacks</h2>
<p>A nice benefit of using this workflow on Github Pages is that we're also creating an artifact ins Git
itself which makes rolling back a standard git operation, something like this:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="command-line-prompt"><span data-user=alex data-host=localhost></span><span data-user=alex data-host=localhost></span><span data-user=alex data-host=localhost></span><span data-user=alex data-host=localhost></span></span><span class="token function">git</span> fetch origin
<span class="token function">git</span> checkout <span class="token parameter variable">-t</span> origin/gh-pages
<span class="token function">git</span> reset <span class="token operator">&lt;</span>commit-id<span class="token operator">></span>
<span class="token function">git</span> push gh-pages <span class="token parameter variable">--force</span></code></pre></div>
<p>One problem: We currently overwrite our history so we can't revert.</p>
<p>To try and remedy this I made a small adjustment:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token comment">## We still checkout the gh-pages branch</span>
<span class="token function">git</span> checkout <span class="token parameter variable">-b</span> gh-pages

<span class="token comment"># But this time, we fetch the existing one</span>
<span class="token function">git</span> fetch origin gh-pages

<span class="token comment"># And soft reset to its latest commit to avoid any conflicts.</span>
<span class="token function">git</span> reset <span class="token parameter variable">--soft</span> origin/gh-pages</code></pre></div>
<h2>Wrapping up</h2>
<p>This workflow has been fantastic for me and I've been able to focus on making site adjustments
without constantly having to repair a build process.</p>
<p><a href="https://github.com/alexwilson/personal-website/blob/master/.github/workflows/build-test-deploy.yml">You can see the entire, finished workflow here</a> and <a href="https://github.com/alexwilson/personal-website/tree/master/.github/actions/github-pages">the custom action here</a>.</p>
<p>As well as Actions I have now added a few bots, a scheduled build (to detect problems) and Slack
notifications, all of which let me keep up-to-date with the fast-moving world of node dependencies
without incurring side-project fatigue.</p>
<p>Next up I'll be looking at creative ways of improving the writing workflow (spellcheck and editor
experience).</p></article><footer><p class="alex-article__infobox">If you enjoyed this article and want to read more, you can follow me:<ul style="margin-top:0"><li class="bullet--rss"><a href="/feed.xml">With your feed reader</a>,</li><li class="bullet--twitter">On <a rel="me" href="https://twitter.com/alexwilsonv1">Twitter</a> , <a rel="me" href="https://bsky.app/profile/alexwilson.bsky.social">Bluesky</a> or <a rel="me" href="https://mastodon.social/@alexwilson">Mastodon</a>,</li><li class="bullet--email"><label for="subscribe_by_email">And in your inbox, by email:</label><form class="alex-form" action="https://tech.us21.list-manage.com/subscribe/post?u=e0869bce049cbcd034fc8edd2&amp;id=7733fc6e4f&amp;f_id=00ef5be1f0" method="post" rel="noreferrer" target="_blank"><div class="alex-form__inline-group"><input class="alex-form__input" placeholder="Your email address" type="email" name="EMAIL" id="subscribe_by_email"/><button class="alex-form__input alex-form__input--submit" type="submit">Subscribe</button></div></form></li></ul>Before you go, if you&#x27;re here via social media: Please leave a like, reply or repost. It really helps with reach!</p></footer><div class="alex-article__sharing-block"></div></div><div class="alex-article__aside"><div class="alex-article__aside-start"><div class="alex-article__topics"><strong>Topics: </strong><ul><li><a href="/topic/devops">devops</a></li><li><a href="/topic/static-site">static-site</a></li><li><a href="/topic/github">github</a></li><li><a href="/topic/release-engineering">release-engineering</a></li></ul></div></div><div class="alex-article__aside-mid"><div class="alex-article__recommended"><h2>Read Next</h2><div class="alex-card"><div class="alex-card__content--container"><div class="alex-card__title"><h3><a href="/content/d7bb0bc3-5bab-4ce7-97ee-602052d007aa">“Ten deploys per day”</a></h3></div></div></div><div class="alex-card"><div class="alex-card__content--container"><div class="alex-card__title"><h3><a href="/content/7c3ed03c-7f97-4e2b-897b-5cf10f830bb0">How to be a CTO: Lessons from LeadingEng 2022</a></h3></div></div></div><div class="alex-card"><div class="alex-card__content--container"><div class="alex-card__title"><h3><a href="/content/3e8ea4c7-60db-496a-9ffb-1d8d3ec23f46">What is Immutable Infrastructure?</a></h3></div></div></div></div></div><div class="alex-article__aside-bottom alex-article__sharing-block"><div class="alex-share"><h3 class="share">Share</h3><ul><li><a href="https://twitter.com/intent/tweet?url=https://alexwilson.tech/content/717e6a35-1cb5-4a28-9321-592d05ddd9dc&amp;amp;text=Deploying static sites with Github Actions&amp;amp;related=AlexWilsonV1&amp;amp;via=AlexWilsonV1"><img src="/svg/twitter.svg" alt="Twitter" title="Share on Twitter"/></a></li><li><a href="http://www.facebook.com/sharer.php?u=https://alexwilson.tech/content/717e6a35-1cb5-4a28-9321-592d05ddd9dc&amp;amp;t=Deploying static sites with Github Actions"><img src="/svg/facebook.svg" alt="Facebook" title="Share on Facebook"/></a></li><li><a href="http://www.linkedin.com/shareArticle?mini=true&amp;amp;url=https://alexwilson.tech/content/717e6a35-1cb5-4a28-9321-592d05ddd9dc&amp;amp;title=Deploying static sites with Github Actions"><img src="/svg/linkedin.svg" alt="LinkedIn" title="Share on LinkedIn"/></a></li><li><a href="http://reddit.com/submit?url=https://alexwilson.tech/content/717e6a35-1cb5-4a28-9321-592d05ddd9dc&amp;amp;title=Deploying static sites with Github Actions"><img src="/svg/reddit.svg" alt="Reddit" title="Share on Reddit"/></a></li></ul></div><div class="alex-webmentions"></div></div></div></div></main><footer class="footer"><div class="container align-center"><span class="text-muted">© Alex Wilson <!-- -->2024</span></div></footer></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/content/717e6a35-1cb5-4a28-9321-592d05ddd9dc";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-ab36bc71a18a5c08a133.js\"],\"component---src-pages-404-js\":[\"/component---src-pages-404-js-32b6d3c9c41e7aae96d1.js\"],\"component---src-pages-about-me-js\":[\"/component---src-pages-about-me-js-6ac8a2df34a996dcd905.js\"],\"component---src-pages-blog-js\":[\"/component---src-pages-blog-js-18b9ba0ef86f575a8582.js\"],\"component---src-pages-consultancy-js\":[\"/component---src-pages-consultancy-js-e5f1ec3c9b2bbe8fa26f.js\"],\"component---src-pages-index-js\":[\"/component---src-pages-index-js-062041c36c6746d44f5d.js\"],\"component---src-pages-talks-js\":[\"/component---src-pages-talks-js-452174c34b66047881a8.js\"],\"component---src-templates-article-js\":[\"/component---src-templates-article-js-1f7d893b64a80e63484b.js\"],\"component---src-templates-talk-js\":[\"/component---src-templates-talk-js-22b0e8458ee495c50e3a.js\"],\"component---src-templates-topic-js\":[\"/component---src-templates-topic-js-fe386798133fbcffef0b.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="32fe6c95d8b41f1de64c";</script><script src="/webpack-runtime-edcb903711c960a3814b.js" async></script><script src="/app-ab36bc71a18a5c08a133.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>